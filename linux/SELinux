Настройка задается контекстом безопасности, который назначается на файлы.

В системе должен быть установлен пакет policycoreutils-python:
yum install policycoreutils-python

Просмотр текущих настроек контекста безопасности:

Для файлов:
ls -Z

Для процессов:
ps -aeZ


Вывод каталогов/файлов и применяемых к ним по умолчанию контекстов безопасности:
semanage fcontext -l


vim /etc/selinux/config

SELINUX=Enforcing все действия, которые каким-то образом нарушают текущую политику безопасности, будут блокироваться, а попытка нарушения будет зафиксирована в журнале.
SELINUX=permissive информация о всех действиях, которые нарушают текущую политику безопасности, будут зафиксированы в журнале,
SELINUX=Disabled

Домен — список действий, которые может выполнять процесс. Обычно в качестве домена определяется минимально-возможный набор действий, при помощи которых процесс способен функционировать. Таким образом, если процесс дискредитирован, злоумышленнику не удастся нанести большого вреда.

Роль — список доменов, которые могут быть применены. Если какого-то домена нет в списке доменов какой-то роли, то действия из этого домена не могут быть применены.

Тип — набор действий, которые допустимы по отношения к объекту. Тип отличается от домена тем, что он может применяться к пайпам, каталогам и файлам, в то время как домен применяется к процессам.

/var/log/audit/audit.log - журнал SELinux

sealert -a /var/log/audit/audit.log > /path/to/mylogfile.txt  - сгенерировать понятные и удобные для человека отчеты


semanage fcontext -a -t httpd_sys_content_t "/html(/.*)?" - присвоили контекст httpd_sys_content_t всем файлам, находящимся в катологе /html.

Предоставление доступа к портам
# semanage port -a -t http_port_t -p tcp 81
